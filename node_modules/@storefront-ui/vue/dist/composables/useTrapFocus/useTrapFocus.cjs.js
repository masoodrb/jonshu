"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("@vueuse/core"),h=require("tabbable"),n=require("vue"),c=require("@storefront-ui/shared"),P=require("../../shared/render.cjs.js");var g=(u=>(u.autofocus="autofocus",u.container="container",u))(g||{});const O={trapTabs:!0,activeState:n.ref(!0),initialFocus:0,initialFocusContainerFallback:!1,arrowKeysOn:!1,arrowKeysLeftRight:!1,arrowKeysUpDown:!1},R=(u,K)=>{const{trapTabs:b,arrowFocusGroupSelector:w,includeContainer:d,activeState:S,initialFocus:t,arrowKeysOn:y,arrowKeysLeftRight:v,arrowKeysUpDown:p,initialFocusContainerFallback:q}={...O,...K},i=n.ref(),s=n.ref([]);let e;const F=()=>{i.value=document.activeElement},f=({event:o,additionalData:a})=>c.focusPrev({current:i.value,focusables:s.value,event:o,...a}),l=({event:o,additionalData:a})=>c.focusNext({current:i.value,focusables:s.value,event:o,...a}),k=o=>{const r=w&&(e==null?void 0:e.querySelector(w))?{arrowFocusGroupSelector:w}:{};y&&(o.key==="ArrowLeft"||o.key==="ArrowUp")&&f({additionalData:r}),y&&(o.key==="ArrowRight"||o.key==="ArrowDown")&&l({additionalData:r}),v&&o.key==="ArrowLeft"&&f({additionalData:r}),v&&o.key==="ArrowRight"&&l({additionalData:r}),p&&o.key==="ArrowUp"&&f({additionalData:r}),p&&o.key==="ArrowDown"&&l({additionalData:r}),b&&c.isTab(o)&&l({event:o}),b&&c.isTabAndShift(o)&&f({event:o})},x=()=>{e==null||e.removeEventListener("keydown",k),e==null||e.removeEventListener("focus",F,!0)};n.watch([u,S],async([o,a])=>{if(o&&a){let r=!1;if(await P.waitForNextRender(),e=m.unrefElement(o),e==null||e.addEventListener("focus",F,!0),e==null||e.addEventListener("keydown",k),s.value=h.tabbable(e,{includeContainer:d}),typeof t=="number")s.value[t]?s.value[t].focus():(console.error(`There is no element with given index ${t}`),r=!0);else if(t==="autofocus"){const A=s.value.find(N=>N.hasAttribute("autofocus"));A?A.focus():r=!0}(q&&r||t==="container")&&(e==null||e.focus())}else s.value=[],i.value=void 0,x()},{immediate:!0});const D=()=>{s.value=h.tabbable(u.value,{includeContainer:d})};return{current:i,focusables:s,focusNext:c.focusNext,focusPrev:c.focusPrev,updateFocusableElements:D}};exports.InitialFocusType=g;exports.useTrapFocus=R;
